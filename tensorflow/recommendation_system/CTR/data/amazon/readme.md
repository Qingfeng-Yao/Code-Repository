## amazon(eletronics)
### 数据简介
- 原始文件`reviews_Electronics_5.json`和`meta_Electronics.json`，来自于[此](http://jmcauley.ucsd.edu/data/amazon/)，数据处理文件来自于[此](https://github.com/DSXiangLi/CTR/tree/master/data/amazon)
- `reviews_Electronics_5.json`中每一行形如`{'reviewerID': 'A2JXAZZI9PHK9Z', 'asin': '0594451647', 'reviewerName': 'Billy G. Noland "Bill Noland"', 'helpful': [3, 3], 'reviewText': 'I am using this with a Nook HD+. It works as described. The HD picture on my Samsung 52&#34; TV is excellent.', 'overall': 5.0, 'summary': 'HDMI Nook adapter cable', 'unixReviewTime': 1388707200, 'reviewTime': '01 3, 2014'}`，共1689188行，其中`reviewerID`为评论者的ID，`asin`为产品的ID，`reviewerName`为评论者的名字，`helpful`为评论的评分(如3/3)，`reviewText`为评论的文本，`overall`为产品的评分，`summary`为评论的概述，`unixReviewTime`为评论的unix时间，`reviewTime`为评论的时间
- `meta_Electronics.json`中每一行形如`{'asin': '0558835155', 'description': 'Use these high quality headphones for internet chatting and enjoy the comfort and ease of the headphones with the microphone and in-line volume control.Works with: Skype msn AIM YAHOO! Windows Live', 'title': 'Polaroid Pbm2200 PC / Gaming Stereo Headphones With Microphone &amp; In-line Volume', 'price': 13.95, 'imUrl': 'http://ecx.images-amazon.com/images/I/21rEirndRLL.jpg', 'categories': [['Electronics', 'Accessories & Supplies', 'Audio & Video Accessories', 'Headphones']]}`，共498196行，其中`asin`为产品的ID，`title`为产品的名字，`price`为价格，`imUrl`为产品图像的url，`categories`为产品属于的类别列表

### 数据处理
- `1_convert_pd.py`: 将`reviews_Electronics_5.json`中的每一行作为字典的value，索引作为key读入字典中，再从字典生成pd.DataFrame，最后写入`reviews.pkl`；`meta_Electronics.json`同样操作，不过只需要读取第一个文件中出现的asin，得到共63001行，最后写入`meta.pkl`
- `2_remap_id.py`: 对`reviews.pkl`中每一条记录只保留`['reviewerID', 'asin', 'unixReviewTime']`，并将`reviewerID`, `asin`对应值转为索引；对`meta.pkl`中每一条记录只保留`['asin', 'categories']`，其中categories只取最后一个类，并将`asin`, `categories`对应值转为索引；统计`评论者数192403，产品数63001，类别数801，样本数1689188`；最后得到`remap.pkl`，由4部分组成，分别是reviews_df(按评论者ID和评论时间排好序的评论记录)、cate_list(按索引排好序的产品对应类组成的列表)和两个元组(一个由user_count, item_count, cate_count, example_count组成，另一个由asin_key, cate_key, revi_key三个列表组成，三个列表分别对应唯一的产品原始ID、唯一的类别原始ID和唯一的评论者原始ID)
- `3_build_dataset.py`: 按评论者进行分组，对每个评论者生成和正样本(假设有N个)一样数目的负样本，对于训练集，使用前N-1个正样本，对于测试集使用所有N个正样本；训练集中每一条数据为一个元组，依次是评论者ID、历史正样本列表，目标正(负)样本和1(或0)，其中历史正样本列表需要遍历N-1个样本得到多条数据；测试集中每一条数据也为一个元组，依次是评论者ID、历史正样本列表(长度为N-1)，目标正(负)样本和1(或0)；shuffle数据集；其中训练集共有2608764条数据，测试集共有384806条数据，生成`dataset.pkl`。对于`3_build_dataset_small.py`，考虑评论者的历史序列长度，在每一条数据中添加评论者的分组信息，且使得训练集的样本数与测试集相同
- `4_dump_tfrecord.py`: 将训练集和测试集数据转换成tfrecords格式，生成`amazon_train.tfrecords`和`amazon_valid.tfrecords`；tfrecords格式要求指明每一条数据的feature，对于该数据集，包括`'reviewer_id', 'hist_item_list', 'hist_category_list', 'hist_length', 'item', 'item_category', 'target'`。对于`4_dump_tfrecord_small.py`，使用小训练集和添加数据特征`reviewer_group`

